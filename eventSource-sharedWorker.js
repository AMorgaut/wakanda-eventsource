var	ports,	sse;ports = [];sse = require("wakanda-eventsource");self.onconnect = function onconnect(msg) {	var		port;	port = msg.ports[0];	port.onmessage = function onmessage(event) {		var			data;		data = event.data;		switch (data.type) {		case sse.SEND_DATAS :			ports.forEach(function dispatchData(listener) {				if (listener !== undefined) {// Totally silly to have this test, the spec should evolve and clear the "element is present"					listener.postMessage({						type: sse.SEND_DATAS, 						message: data.data					});				}			});			break;		case "register" :			ports.push(port);			port.postMessage({				type: "ack", 				ref: ports.length			});			break;		case "disconnect" :			ports[message.ref - 1] = undefined;			break;		default:			console.warning('unexpected message', data);		}	};};